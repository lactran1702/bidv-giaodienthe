$(document).ready(function(){var e=function(e){for(var a=e+"=",t=decodeURIComponent(document.cookie).split(";"),l=0;l<t.length;l++){for(var s=t[l];" "==s.charAt(0);)s=s.substring(1);if(0==s.indexOf(a))return s.substring(a.length,s.length)}return""};!function(){if(""==e("SN_C")){for(var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t="",l=0;l<a.length;l++)t+=a.charAt(Math.floor(Math.random()*a.length));!function(e){document.cookie="SN_C ="+e+";path=/"}($.md5(t))}}();var a=function(e,a,t,l){$(".result").css("display","block"),$(".suggest").css("display","none");var s=a/10+1;if(""!=e){var r=new XMLHttpRequest;(e='"'+(e=e.replace(/"/g,"").replace(/'/g,""))+'"').toString();r.open("GET","/wps/contenthandler/searchfeed/search?query="+e+"&scope="+t+"&start="+a+"&results=10",!1),r.send();var i=r.responseXML,n=(new XMLSerializer).serializeToString(i).replace(/\&/g,"^"),c=(new X2JS).xml_str2json(n),o=[],g=[],u=[],p=[],d=" ",h=" ";if(void 0==c.feed)return;var f=c.feed.totalResults.__text;if(0==f)h="";else if(f<=10)h="<li data-page='1' class='active'><a title='1'>1</a></li>";else{if(0==f%10){if((v=f/10)<=5)for(m=1;m<=v;m++)h+=m==s?"<li data-page='"+m+"' class='active'><a class='result-page' title='"+m+"'>"+m+"</a></li>":"<li data-page='"+m+"' class=''><a class='result-page' title='"+m+"'>"+m+"</a></li>";else if(s<4){for(y=1;y<=4;y++)h+=y==s?"<li data-page='"+y+"' class='active'><a class='result-page' title='"+y+"'>"+y+"</a></li>":"<li data-page='"+y+"' class=''><a class='result-page' title='"+y+"'>"+y+"</a></li>";h+="...",h+="<li data-page='"+v+"' class=''><a class='result-page' title='"+v+"'>"+v+"</a></li>"}else if(s>v-2){h+="<li data-page='1' class=''><a class='result-page' title='1'>1</a></li>",h+="...";for(y=v-3;y<=v;y++)h+=y==s?"<li data-page='"+y+"' class='active'><a class='result-page' title='"+y+"'>"+y+"</a></li>":"<li data-page='"+y+"' class=''><a class='result-page' title='"+y+"'>"+y+"</a></li>"}else{h+="<li data-page='1' class=''><a class='result-page' title='1'>1</a></li>",h+="...",h+="<li data-page='"+(w=s-1)+"' class=''><a class='result-page' title='"+w+"'>"+w+"</a></li>",h+="<li data-page='"+s+"' class='active'><a class='result-page' title='"+s+"'>"+s+"</a></li>",h+="<li data-page='"+(k=s+1)+"' class=''><a class='result-page' title='"+k+"'>"+k+"</a></li>",h+="...",h+="<li data-page='"+v+"' class=''><a class='result-page' title='"+v+"'>"+v+"</a></li>"}}else{var v=Math.floor(f/10)+1;if(v<=5)for(var m=1;m<=v;m++)h+=m==s?"<li data-page='"+m+"' class='active'><a class='result-page' title='"+m+"'>"+m+"</a></li>":"<li data-page='"+m+"' class=''><a class='result-page' title='"+m+"'>"+m+"</a></li>";else if(s<4){for(y=1;y<=4;y++)h+=y==s?"<li data-page='"+y+"' class='active'><a class='result-page' title='"+y+"'>"+y+"</a></li>":"<li data-page='"+y+"' class=''><a class='result-page' title='"+y+"'>"+y+"</a></li>";h+="...",h+="<li data-page='"+v+"' class=''><a class='result-page' title='"+v+"'>"+v+"</a></li>"}else if(s>v-2){h+="<li data-page='1' class=''><a class='result-page' title='1'>1</a></li>",h+="...";for(var y=v-3;y<=v;y++)h+=y==s?"<li data-page='"+y+"' class='active'><a class='result-page' title='"+y+"'>"+y+"</a></li>":"<li data-page='"+y+"' class=''><a class='result-page' title='"+y+"'>"+y+"</a></li>"}else{var k=s+1,w=s-1;h+="<li data-page='1' class=''><a class='result-page' title='1'>1</a></li>",h+="...",h+="<li data-page='"+w+"' class=''><a class='result-page' title='"+w+"'>"+w+"</a></li>",h+="<li data-page='"+s+"' class='active'><a class='result-page' title='"+s+"'>"+s+"</a></li>",h+="<li data-page='"+k+"' class=''><a class='result-page' title='"+k+"'>"+k+"</a></li>",h+="...",h+="<li data-page='"+v+"' class=''><a class='result-page' title='"+v+"'>"+v+"</a></li>"}}}if($("#"+l).find(".pagination-link").html(h),0==c.feed.totalResults.__text)$("#"+l).find(".total-results").text("0"),$("#"+l).find(".search-wrap").html("");else if(1!=c.feed.totalResults.__text&&c.feed.entry[1])$("#"+l).find(".total-results").text(c.feed.totalResults.__text),$.each(c.feed.entry,function(e,a){o[e]=a,g[e]=a.title.__text,void 0!=a.summary?u[e]=a.summary.__cdata.slice(25):u[e]="";var t=g[e].toString().replace(/\/n /g,""),l=u[e].toString().replace("Component Action Menu ${title} ${loading} Actions.","").replace("Edit mode Edit mode is active.","").replace("Edit mode Edit mode is inactive.","").replace("Toolbar The toolbar is closed.","").replace("Edit mode is disabled for this page.","").replace("Web Content Viewer.","").replace(/\^ndash;/g,"-").replace(/\^rdquo;/g,'"').replace(/\^ldquo;/g,'"').replace(/\/n /g,"");p[e]=a.link[0]._href.replace(/\^amp;/g,"&"),d+="<div class='search-item'><h3 class='search-title'><a href='/wps/portal/"+p[e]+"' title='"+t+"'>"+t+"</a></h3><p style='line-height:20px; margin-bottom: 10px;'>"+l+"</p></div>"}),$("#"+l).find(".search-wrap").html(d);else{$("#"+l).find(".total-results").text(c.feed.totalResults.__text);var x=c.feed.entry.link[0]._href.replace(/\^amp;/g,"&"),S=c.feed.entry.title.__text,_=c.feed.entry.summary;d+="<div class='search-item'><h3 class='search-title'><a href='/wps/portal/"+x+"' title='"+S.toString().replace(/\/n /g,"")+"'>"+S.toString().replace(/\/n /g,"")+"</a></h3><p style='line-height:20px; margin-bottom: 10px;'>"+_.toString().replace(/\^ndash;/g,"-").replace(/\^rdquo;/g,'"').replace(/\^ldquo;/g,'"')+"</p><ul class='breadcrumbs'></ul></div>",$("#"+l).find(".search-wrap").html(d)}}else $("#"+l).find(".total-results").text("0"),$("#"+l).find(".search-wrap").html(""),$("#"+l).find(".pagination-link").html("")},t=function(a){e("SN_C");var t=localStorage.getItem("key_stor");if(""!=a){var l='{"count":"1","keyword":"'+(a=a.replace(/"/g,"").replace(/'/g,""))+'"}';if(""!=t){for(var s=t,r=JSON.parse(s),i="",n="",c="",o=0;o<r.length;o++){if(r[o].keyword==a){i="true",n=r[o].count,c=o;break}i="flase"}if("true"==i){var g='{"count":"'+(parseInt(n)+1)+'","keyword":"'+a+'"}';r.splice(c,1);var u=JSON.parse(g);r.push(u);h=JSON.stringify(r)}else{var p=JSON.parse(l);if(r.push(p),r.length>5)d=r.slice(1,6);else var d=r;var h=JSON.stringify(d)}}else h="["+l+"]";localStorage.setItem("key_stor",h)}},l=function(e){var a=localStorage.getItem("key_stor");if(""==a||null==a){localStorage.setItem("key_stor","");for(var t=[],l=[],r=0;r<e.length;r++)0==e[r].type?t.push(e[r]):l.push(e[r]);if(t.length>6)var i=t.length-1,n=t.length-6;else var i=t.length-1,n=0;if(l.length>6)var c=l.length-1,o=l.length-6;else var c=l.length-1,o=0;for(var g="",u="",p=i;p>=n;p--)g+="<li><a class='suggestion-item' title='"+t[p].keyword+"'>"+t[p].keyword+"</a></li>";for(w=c;w>=o;w--){var d="",h="",f="";if(""!==l[w].icon&&null!==l[w].icon)h="<img src='"+(d=l[w].icon.replace("myconnect","connect"))+"' alt='"+l[w].keyword+"'>";if(""!==l[w].url&&null!==l[w].url)f="href='"+l[w].url+"'";else f="style='cursor: context-menu;'";u+="<li><a "+f+" class='suggestion-item' title='"+l[w].keyword+"'>"+h+"<span>"+l[w].keyword+"</span></a></li>"}s(g,u)}else{for(var v=JSON.parse(a),m=[],r=0;r<v.length;r++)for(var y=0;y<e.length;y++)-1!=String(e[y].keyword).indexOf(v[r].keyword)&&m.push(e[y]);var k=[];$.each(m,function(e,a){-1===$.inArray(a,k)&&k.push(a)});for(var t=[],l=[],r=0;r<k.length;r++)0==k[r].type?t.push(k[r]):l.push(k[r]);if(0==t.length)for(r=0;r<e.length;r++)0==e[r].type&&t.push(e[r]);if(0==l.length)for(r=0;r<e.length;r++)1==e[r].type&&l.push(e[r]);if(t.length>6)var i=t.length-1,n=t.length-6;else var i=t.length-1,n=0;if(l.length>6)var c=l.length-1,o=l.length-6;else var c=l.length-1,o=0;for(var g="",u="",p=i;p>=n;p--)g+="<li><a class='suggestion-item' title='"+t[p].keyword+"'>"+t[p].keyword+"</a></li>";for(var w=c;w>=o;w--){var d="",h="",f="";if(""!==l[w].icon&&null!==l[w].icon)h="<img src='"+(d=l[w].icon.replace("myconnect","connect"))+"' alt='"+l[w].keyword+"'>";if(""!==l[w].url&&null!==l[w].url)f="href='"+l[w].url+"'";else f="style='cursor: context-menu;'";u+="<li><a "+f+" class='suggestion-item' title='"+l[w].keyword+"'>"+h+"<span>"+l[w].keyword+"</span></a></li>"}s(g,u)}},s=function(e,a){$(".suggestion-0").html(e),$(".suggestion-1").html(a)};$(".btn-search-popup").on("click",function(){$("body").addClass("fixed-screen").find(".search-result").fadeIn(400),$(".result").css("display","none"),$(".suggest").css("display","block"),$("#search-input").val(""),function(){if("vn"==$(".group-languages").find(".language-checked").attr("data-lang"))e="/ServicesBIDV/KeywordSearchServlet?site=vi";else var e="/ServicesBIDV/KeywordSearchServlet?site=en";$.getJSON(e).done(function(e){l(e),$("#search-input").on("keyup",function(a){$(".suggestion-0").html(""),$(".suggestion-1").html(""),13!=a.keyCode&&($(".result").css("display","none"),$(".suggest").css("display","block")),function(e,a){var t=[],l=[],s=[],r=[];if("vn"==$(".newsletter-wrap").attr("data-lang"))i="<li>Không có gợi ý</li>";else var i="<li>No results suggested</li>";if(""==e)$(".suggestion-0").append(i),$(".suggestion-1").append(i);else{for(var n=0;n<a.length;n++)0==a[n].type?s.push(a[n]):r.push(a[n]);for(var c=0;c<s.length;c++)-1!=s[c].keyword.toLowerCase().indexOf(e)&""!=e&&t.push(s[c]);for(var o=0;o<r.length;o++)-1!=r[o].keyword.toLowerCase().indexOf(e)&""!=e&&l.push(r[o]);if(t.length>0)for(var g=0;g<t.length;g++)htmlPost="<li><a class='suggestion-item' title='"+t[g].keyword+"'>"+t[g].keyword+"</a></li>",$(".suggestion-0").append(htmlPost);else $(".suggestion-0").append(i);if(l.length>0)for(var u=0;u<l.length;u++){var p="",d="";""!==l[u].icon&&null!==l[u].icon&&(p="<img src='"+l[u].icon.replace("myconnect","connect")+"' alt='"+l[u].keyword+"'>"),d=""!==l[u].url&&null!==l[u].url?"href='"+l[u].url+"'":"style='cursor: context-menu;'",htmlProduct="<li><a "+d+" class='suggestion-item' title='"+l[u].keyword+"'>"+p+"<span>"+l[u].keyword+"</span></a></li>",$(".suggestion-1").append(htmlProduct)}else $(".suggestion-1").append(i)}}($("#search-input").val(),e)})})}()}),$(".search-result__block").on("click",".close-search-result",function(){$("body").removeClass("fixed-screen").find(".search-result").fadeOut(400)}),$(".close-search").click(function(){return $("body").removeClass("fixed-screen").find(".search-result").fadeOut(400),!1}),$(".result-suggestion").on("click",".suggestion-item",function(){var e=$("#search-input").val(),l=$(this).text();t(e);if("vn"==$(".group-languages").find(".language-checked").attr("data-lang"))var s="1541669436812",r="1541669066187",i="1541669268572",n="1541669335632",c="1541669154036";else{var s="1541669365442",r="1541668943316",i="1541669198126";n="1541669300655",c="1541669095003"}$("#search-input").val(l);a(l,0,s,"search-all"),a(l,0,r,"search-news"),a(l,0,i,"search-product"),a(e,0,n,"search-promotion"),a(e,0,c,"search-other")}),$(".search-field").submit(function(){if("vn"==$(".group-languages").find(".language-checked").attr("data-lang"))var e="1541669436812",l="1541669066187",s="1541669268572",r="1541669335632",i="1541669154036";else{var e="1541669365442",l="1541668943316",s="1541669198126";r="1541669300655",i="1541669095003"}var n=$("#search-input").val();t(n);return a(n,0,e,"search-all"),a(n,0,l,"search-news"),a(n,0,s,"search-product"),a(n,0,r,"search-promotion"),a(n,0,i,"search-other"),!1}),$("#search-all").on("click",".result-page",function(){var e=$("#search-input").val(),t=10*($(this).context.innerText-1);if("vn"==$(".group-languages").find(".language-checked").attr("data-lang"))l="1541669436812";else var l="1541669365442";a(e,t,l,"search-all")}),$("#search-news").on("click",".result-page",function(){var e=$("#search-input").val(),t=10*($(this).context.innerText-1);if("vn"==$(".group-languages").find(".language-checked").attr("data-lang"))l="1541669066187";else var l="1541668943316";a(e,t,l,"search-news")}),$("#search-product").on("click",".result-page",function(){var e=$("#search-input").val(),t=10*($(this).context.innerText-1);if("vn"==$(".group-languages").find(".language-checked").attr("data-lang"))l="1541669268572";else var l="1541669198126";a(e,t,l,"search-product")}),$("#search-promotion").on("click",".result-page",function(){var e=$("#search-input").val(),t=10*($(this).context.innerText-1);if("vn"==$(".group-languages").find(".language-checked").attr("data-lang"))l="1541669335632";else var l="1541669300655";a(e,t,l,"search-promotion")}),$("#search-other").on("click",".result-page",function(){var e=$("#search-input").val(),t=10*($(this).context.innerText-1);if("vn"==$(".group-languages").find(".language-checked").attr("data-lang"))l="1541669154036";else var l="1541669095003";a(e,t,l,"search-other")}),$(".search-tab-nav a").on("click",function(){var e=$(this).attr("href");return $(".search-tab-nav li").removeClass("active"),$(this).parent().addClass("active"),$(".search-result-wrap .tab-content").fadeOut(400),$(e).fadeIn(400),!1})});